<!DOCTYPE html>
<html lang="zxx">
   <head>
      <meta charset="UTF-8" />
      <meta
         name="description"
         content="Hiroto Template" />
      <meta
         name="keywords"
         content="Hiroto, unica, creative, html" />
      <meta
         name="viewport"
         content="width=dev-width, initial-scale=1.0" />
      <meta
         http-equiv="X-UA-Compatible"
         content="ie=edge" />

      <title>BookingSystem</title>

      <!-- icon web -->
      <link
         rel="icon"
         href="/client/img/iconlogo.png" />

      <!--boxi icon -->
      <link
         href="https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css"
         rel="stylesheet" />
      <link
         rel="stylesheet"
         href="/client/css/elegant-icons.css"
         type="text/css" />
      <!-- fontawesome -->
      <link
         rel="stylesheet"
         href="/client/css/font-awesome.min.css"
         type="text/css" />
      <link
         rel="stylesheet"
         href="/client/css/bootstrap.min.css"
         type="text/css" />
      <link
         rel="stylesheet"
         href="/client/css/header-bootstrap.css"
         type="text/css" />

      <!-- Css Styles -->
      <link
         rel="stylesheet"
         href="/client/css/owl.carousel.min.css"
         type="text/css" />

      <link
         rel="stylesheet"
         href="/client/css/style.css"
         type="text/css" />
      <link
         rel="stylesheet"
         href="/client/css/header.css"
         type="text/css" />
      <link
         rel="stylesheet"
         href="/client/css/room.css"
         type="text/css" />
      <link
         rel="stylesheet"
         href="/client/css/my-booking.css"
         type="text/css" />

      <!-- toast -->
      <link
         rel="stylesheet"
         href="/client/css/toastr.css"
         type="text/css" />
      <style>
         .text-child {
            color: blue;
         }

         .text-adult {
            color: green;
         }
      </style>
   </head>
   <% const TICKET_TYPE_NAME = { type1: 'Phổ thông', type2: 'Phổ thông cao cấp',
   type3: 'Thương gia', type4: 'Hạng nhất', };const statusColors = { WAITING:
   'bg-primary', ACCEPT: 'bg-success', CANCEL: 'bg-danger', DONE: 'bg-info' };
   %>

   <body>
      <div class="loading">
         <div class="loader"></div>
      </div>
      <div id="header">
         <div class="header-nav">
            <div class="header-logo">
               <img
                  src="/client/img/mylogo.svg"
                  alt=""
                  class="logo" />
            </div>
            <ul class="nav-list">
               <li class="nav-item">
                  <a
                     href="/"
                     class="nav-link-nb nav-link-nb-main"
                     >Trang chủ</a
                  >
               </li>

               <li class="nav-item">
                  <a
                     href="/rooms"
                     class="nav-link-nb"
                     >Khách sạn & Resort</a
                  >
               </li>
               <li class="nav-item">
                  <a
                     href="/Flights"
                     class="nav-link-nb"
                     >Vé máy bay</a
                  >
               </li>
               <li class="nav-item">
                  <a
                     href="/hotel"
                     class="nav-link-nb"
                     >Thông tin</a
                  >
               </li>
               <li class="nav-item">
                  <a
                     href="/location"
                     class="nav-link-nb"
                     >Vị trí</a
                  >
               </li>
            </ul>
         </div>
         <div class="header-account">
            <a
               class="btn-login btn-account"
               href="/login"
               ><i class="bx bx-user"></i>Đăng nhập
            </a>
            <a
               class="btn-register btn-account"
               href="/register"
               >Đăng ký
            </a>
         </div>
      </div>
      <div
         style="height: 250px"
         id="booking"
         class="section">
         <div class="section-center">
            <div class="container">
               <div class="row">
                  <div class="col-lg-12">
                     <div class="section-title">
                        <h5
                           style="
                              font-size: 30px;
                              color: #fff;
                              font-weight: bold;
                           ">
                           Tìm phòng nhanh chóng, dễ dàng và tiện lợi ở hotel
                           ANG
                        </h5>
                     </div>
                  </div>
               </div>
            </div>
         </div>
      </div>

      <!-- Rooms Section Begin -->
      <section
         style="padding-top: 10px"
         class="rooms">
         <div class="container">
            <div class="row">
               <div class="col-lg-12">
                  <div class="section-title">
                     <h5 style="font-size: 30px; margin: 10px 0">
                        Thông tin chi tiết vé máy bay bạn đã đặt
                     </h5>
                  </div>
               </div>
            </div>
            <div class="row">
               <div class="container mt-5">
                  <div
                     class="card m-md-4"
                     style="
                        padding: 20px;
                        border-radius: 15px;
                        box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
                     ">
                     <div class="row">
                        <div class="col-md-4">
                           <h4
                              style="color: rgb(241, 69, 69)"
                              class="card-title">
                              Mã vé:# <%= data.flight_booking_id %>
                           </h4>
                           <p>
                              <strong>Tên người đặt:</strong> <%=
                              data.fullnameCustomer %>
                           </p>
                           <p>
                              <strong>Email:</strong> <%= data.emailCustomer %>
                           </p>
                           <p>
                              <strong>Số điện thoại:</strong> <%=
                              data.phoneCustomer %>
                           </p>
                           <p>
                              <strong>Trạng thái:</strong>
                              <span
                                 class="badge <%= statusColors[data.status] %>"
                                 ><%= data.status %></span
                              >
                           </p>
                           <p>
                              <strong>Tổng giá:</strong> <%= new
                              Intl.NumberFormat('vi-VN', { style: 'currency',
                              currency: 'VND' }).format(data.total_price) %>
                           </p>
                           <p>
                              <strong>Ngày đặt:</strong> <%= new
                              Intl.DateTimeFormat('vi-VN').format(new
                              Date(data.booking_date)) %>
                           </p>
                           <p>
                              <strong>Loại vé:</strong> <%=
                              TICKET_TYPE_NAME[data.ticketType] %>
                           </p>
                           <p>
                              <strong>Số người lớn:</strong> <%= data.adultCount
                              %>
                           </p>
                           <p>
                              <strong>Số trẻ em:</strong> <%= data.childCount %>
                           </p>
                        </div>
                        <div class="col-md-8">
                           <h4 class="card-title">Danh sách hành khách</h4>
                           <table class="table table-bordered">
                              <thead>
                                 <tr>
                                    <th class="text-left">Tên hành khách</th>
                                    <th class="text-center">Loại hành khách</th>
                                    <th class="text-center">Giới tính</th>
                                    <th class="text-center">Ngày sinh</th>
                                    <th class="text-center">Passport</th>
                                    <th class="text-center">
                                       Chứng minh nhân dân
                                    </th>
                                 </tr>
                              </thead>
                              <tbody>
                                 <% for (let j = 0; j <
                                 data.passengerData.length; j++) { %>
                                 <tr>
                                    <td class="text-left">
                                       <%= data.passengerData[j].fullname %>
                                    </td>
                                    <% if (data.passengerData[j].type_passenger
                                    == 'child') { %>
                                    <td class="text-center text-child">
                                       Trẻ em
                                    </td>
                                    <% } else { %>
                                    <td class="text-center text-adult">
                                       Người lớn
                                    </td>
                                    <% } %>
                                    <td class="text-center">
                                       <% if (data.passengerData[j].gender ==
                                       'male') { %> Nam <% } else if
                                       (data.passengerData[j].gender ==
                                       'female') { %> Nữ <% } %>
                                    </td>
                                    <td class="text-center">
                                       <%= data.passengerData[j].birthdate %>
                                    </td>
                                    <td class="text-center">
                                       <%= data.passengerData[j].passport %>
                                    </td>
                                    <td class="text-center">
                                       <%= data.passengerData[j].idcard %>
                                    </td>
                                 </tr>
                                 <% } %>
                              </tbody>
                           </table>
                        </div>
                     </div>
                     <% if (data.status == 'WAITING') { %>
                     <button
                        style="width: 200px"
                        class="btn btn-danger"
                        onclick="cancelTicket('<%= data.flight_booking_id %>')">
                        Hủy đặt vé
                     </button>
                     <% } %>
                  </div>
               </div>
            </div>

            <div class="btn-on-top"></div>
         </div>
      </section>

      <!--==================================== -->

      <script
         src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"
         integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p"
         crossorigin="anonymous"></script>

      <!-- Js Plugins -->

      <!-- <script src="/client/js/jquery-3.3.1.min.js"></script> -->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.js"></script>
      <script src="/client/js/jquery.slicknav.js"></script>
      <script src="/client/js/owl.carousel.min.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
      <!-- toast -->
      <script src="/client/js/toastr.js"></script>

      <script src="/client/js/main.js"></script>
      <script src="/client/js/header.js"></script>
      <script src="/client/js/room.js"></script>
      <script src="/client/js/setheader.js"></script>
      <script>
         function showErr(msg) {
            toastr['warning'](msg);
         }
         function showSuccess(msg) {
            toastr['success'](msg);
         }
         const urlParams = new URLSearchParams(window.location.search);

         // Lấy mã chuyến bay và loại vé muốn đặt trên url
         const isBooking = urlParams.get('isBooking');
         if (isBooking) {
            showSuccess('Bạn đã đặt vé thành công');
            showSuccess('Bạn đã đặt vé thành công');
            showSuccess('Bạn đã đặt vé thành công');
         }

         function cancelTicket(flightBookingId) {
            const tokenCancel = urlParams.get('tokenCancel');
            window.location.href = `/Flights/cancel?id=${flightBookingId}&tokenCancel=${tokenCancel}`;
         }
      </script>
   </body>
</html>
